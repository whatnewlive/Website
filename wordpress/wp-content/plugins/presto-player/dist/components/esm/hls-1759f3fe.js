import{P as PrestoPlayer}from"./presto-player.presto-playlist-item.presto-playlist-overlay.presto-playlist-ui-3d2bbeaa.js";import"./index-56b61ec5.js";import"./util-82d7532d.js";import"./cache-cues-a2067c2e.js";const loadHLS=({config:e,selector:t,src:o,preload:r})=>new Promise((async(a,n)=>{if(!window.Hls)for(;!window.hasOwnProperty("Hls");)await new Promise((e=>setTimeout(e,50)));if(window.Hls.isSupported()){let n=!["metadata","none"].includes(r);wp?.blocks&&(n=!0);var l=new window.Hls(window?.wp?.hooks?.applyFilters?.("presto.hlsSettings",{autoStartLoad:n,capLevelToPlayerSize:!0}));return l.loadSource(o),l.on(window.Hls.Events.LEVEL_SWITCHED,((e,o)=>{var r=t.closest(".presto-player__wrapper").querySelector(".plyr__menu__container [data-plyr='quality'][value='0'] span");l.autoLevelEnabled?r.innerHTML=`AUTO (${l.levels[o.level].height}p)`:r.innerHTML="AUTO"})),void l.on(window.Hls.Events.MANIFEST_PARSED,(function(o,r){var n=l.levels.map((function(e){return e.height}));n.unshift(0);const s=(n||[]).findIndex((e=>e===parseInt(window?.prestoPlayer?.hls_start_level)));l.startLevel=s?s-1:2,e.quality={default:0,options:n,forced:!0,onChange:function(e){0===e?prestoHLS.currentLevel=-1:prestoHLS.levels.forEach((function(t,o){t.height===e&&(console.log("Found quality match with "+e),prestoHLS.currentLevel=o)}))}},l.attachMedia(t),window.prestoHLS=l;const i=new PrestoPlayer(t,{...e});i.hls=l;const p=()=>{l.startLoad(-1),i.off("waiting",p)};return i.on("waiting",p),i.on("languagechange",(()=>{setTimeout((()=>l.subtitleTrack=i.currentTrack),50)})),a(i)}))}return t.canPlayType("application/vnd.apple.mpegurl"),a(new PrestoPlayer(t,{...e}))}));export{loadHLS as default};